CREATE TABLE `USER` (
	Username VARCHAR(45) NOT NULL,
	Password VARCHAR(45) NOT NULL,
	IsAdmin BOOLEAN NOT NULL,
	PRIMARY KEY (Username) );

CREATE TABLE PASSENGER (
	Username VARCHAR(45) NOT NULL,
	Email VARCHAR(45) NOT NULL,
	PRIMARY KEY (Username),
	UNIQUE (Email),
	FOREIGN KEY (Username) REFERENCES USER(Username)
	ON DELETE CASCADE ON UPDATE CASCADE );

CREATE TABLE BREEZE_CARD (
	Number CHAR(16) NOT NULL,
	Value DECIMAL(6,2) NOT NULL,
	Username VARCHAR(45) ,
	PRIMARY KEY (Number),
    CHECK (Value >= 0.00 and Value <= 1000.00),
	FOREIGN KEY (Username) REFERENCES PASSENGER(Username)
	ON DELETE SET NULL ON UPDATE CASCADE );

CREATE TABLE CONFLICT (
	DateTime TIMESTAMP NOT NULL,
	Username VARCHAR(45) NOT NULL,
	Number CHAR(16) NOT NULL,
	PRIMARY KEY (Username, Number),
	FOREIGN KEY (Username) REFERENCES PASSENGER(Username)
	ON DELETE CASCADE ON UPDATE CASCADE,
	FOREIGN KEY (Number) REFERENCES BREEZE_CARD(Number)
	ON DELETE CASCADE ON UPDATE CASCADE );

CREATE TABLE STATION (
	StopID VARCHAR(45) NOT NULL,
	EnterFare Decimal(4, 2) NOT NULL,
	ClosedStatus BOOLEAN NOT NULL,
	Name VARCHAR(45) NOT NULL,
	IsTrainStation BOOLEAN NOT NULL,
    CHECK (EnterFare >= 0.00 and EnterFare <= 50.00),
	PRIMARY KEY (StopID),
	UNIQUE (Name, IsTrainStation) );

CREATE TABLE TRIP (
	CurrentFare Decimal(4, 2) NOT NULL,
	StartTime TIMESTAMP NOT NULL,
	StartsStopID VARCHAR(45) NOT NULL,
	Number CHAR(16) NOT NULL,
	EndsStopID VARCHAR(45),
	PRIMARY KEY (StartTime, Number),
	FOREIGN KEY (Number) REFERENCES BREEZE_CARD(Number)
	ON DELETE CASCADE ON UPDATE CASCADE,
	FOREIGN KEY (StartsStopID) REFERENCES STATION(StopID)
	ON DELETE CASCADE ON UPDATE CASCADE,
	FOREIGN KEY (EndsStopID) REFERENCES STATION(StopID)
	ON DELETE CASCADE ON UPDATE CASCADE );

CREATE TABLE BUS_STATION (
	StopID VARCHAR(45) NOT NULL,
	Intersection VARCHAR(45) NOT NULL,
	PRIMARY KEY (StopID),
	FOREIGN KEY (StopID) REFERENCES STATION(StopID)
	ON DELETE CASCADE ON UPDATE CASCADE );